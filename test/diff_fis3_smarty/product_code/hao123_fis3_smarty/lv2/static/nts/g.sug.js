!function(WIN,DOC,undef){"".trim||(String.prototype.trim=function(){var str=this,str=str.replace(/^\s\s*/,""),ws=/\s/,i=str.length;while(ws.test(str.charAt(--i)));return str.slice(0,i+1)});"".replaceTpl||(String.prototype.replaceTpl=function(o){return this.replace(/#\{([^}]*)\}/gm,function(a,b){return a=o[b.trim()]})});"".htmlEncode||(String.prototype.htmlEncode=function(){return String(this).replace(/\x26/g,"&amp;").replace(/\x3c/g,"&lt;").replace(/\x3E/g,"&gt;").replace(/\x22/g,"&quot;").replace(/\x27/g,"&#39;").replace(/\xA9/g,"&copy;")});var SPACE=" ",NULL=null,CLASSLIST=document.documentElement.classList!==undef,isIE=/\w/.test("Ä°"),isIE6=isIE&&!WIN.XMLHttpRequest,isIE9=DOC.documentMode&&DOC.documentMode===9,namespace=function(s){if(!s)return;var ret=s.split("."),len=ret.length,context=window,i=0,p;if(len>1){for(;i<len-1;i++){p=ret[i];context=0===i&&context[p]?context[p]:p in context?context[p]:context[p]={}}}return context},hasClass=CLASSLIST?function(el,cls){return el.classList.contains(cls)}:function(el,cls){return-1<(SPACE+el.className+SPACE).indexOf(SPACE+cls+SPACE)},addClass=CLASSLIST?function(el,cls){el.classList.add(cls)}:function(el,cls){if(!hasClass(el,cls))el.className+=(el.className?SPACE:"")+cls},removeClass=CLASSLIST?function(el,cls){el.classList.remove(cls)}:function(el,cls){if(!hasClass(el,cls))return;var reg=new RegExp("(\\s|^)"+cls+"(\\s|$)");el.className=el.className.replace(reg,SPACE)},on=DOC.addEventListener?function(el,type,callback){el.addEventListener(type,callback,!1)}:function(el,type,callback){el.attachEvent("on"+type,callback)},bind=function(el,type,fun){on(el,type,function(e){e=e||WIN.event;var el=e.srcElement||e.target;fun.call(el,e)})},getStyle=isIE?function(el,style){style=style.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()});return el.currentStyle[style]}:function(el,style){return DOC.defaultView.getComputedStyle(el,null).getPropertyValue(style)},_sug=function(el,o){if(!(this instanceof _sug))return new _sug(el,o);var that=this;that.el=el+""===el?DOC.getElementById(el):el;if(!that.el)return;that.o={classNameWrap:o.classNameWrap||"sug-wrap",classNameQuery:o.classNameQuery,classNameQueryNull:o.classNameQueryNull,classNameSelect:o.classNameSelect||"sug-select",classNameClose:o.classNameClose||"sug-close",classNameShim:o.classNameShim||"sug-shim",locAbs:o.locAbs||false,pressDelay:o.pressDelay===undef?3:o.pressDelay,autoFocus:o.autoFocus||false,delay:o.delay||200,n:o.n||10,t:o.t||true,autoCompleteData:o.autoCompleteData||false,url:o.url||false,charset:o.charset,callbackFn:o.callbackFn||false,callbackName:o.callbackName||false,callbackDataKey:o.callbackDataKey||false,callbackDataNum:o.callbackDataNum||false,requestQuery:o.requestQuery||false,requestParas:o.requestParas||{},noSubmit:o.noSubmit||false,onSelect:o.onSelect,onShow:o.onShow,onHide:o.onHide,onRequest:o.onRequest,onSucess:o.onSucess,onError:o.onError,customUrl:o.customUrl||false,templ:o.templ||false};that.wrap=that.el.parentNode;that.init()},_=_sug.prototype;_.init=function(){var that=this,o=that.o;that.layoutInit();that.reset();that.inputHandle();o.autoFocus&&setTimeout(function(){that.el.focus()},16);if(o.autoCompleteData)return;var callbackFn=o.callbackFn,context=namespace(callbackFn,true),ret=callbackFn.split("."),lastName=ret.pop();that.callback=function(data){data=data||{};var self=arguments.callee;that=callbackFn&&self.repeat?self.context||that:that;that.o.onSucess&&that.o.onSucess.call(that);var key=that.o.callbackDataKey||that.o.callbackDataNum,_data=key?data[key]:data;if(!_data||!_data.length){that.hide(1);that.isHide=false;return}that.fill(data,that.q);that.show();that.cache[that.q]=data};if(context[lastName])context[lastName].repeat=true;else if(callbackFn)context[lastName]=that.callback};_.reset=function(o){var that=this,k;for(k in o)that.o[k]=o[k];that.cache={};that.q="";that.s=NULL;that.i=-1;that.inputTimer();that.isHide=false;that.hide(1)};_.layoutInit=function(){var that=this,o=that.o,wrap=o.locAbs?DOC.body:that.wrap,sugWrap=that.sugWrap=DOC.createElement("div");that.el.setAttribute("autocomplete","off");if(isIE6){var shim=that.shim=sugWrap.appendChild(DOC.createElement("iframe"));shim.src="about:blank";addClass(shim,o.classNameShim);shim.frameBorder=0;shim.scrolling="no";that.content=sugWrap.appendChild(sugWrap.cloneNode(null))}else{that.content=sugWrap}addClass(sugWrap,o.classNameWrap);!o.locAbs&&getStyle(wrap,"position")==="static"&&(wrap.style.position="relative");wrap.appendChild(sugWrap)};_.show=function(){this.sugWrap.style.display="";this.o.onShow&&this.o.onShow.call(this)};_.hide=function(type){var that=this;that.sugWrap.style.display="none";that.q=that.el.value;if(type!=2){that.s=NULL;that.i=-1}type==1&&that.fill();that.o.onHide&&that.o.onHide.call(that)};_.holdFocus=function(el,e){if(e.preventDefault){e.preventDefault()}else{el.onbeforedeactivate=function(){WIN.event.returnValue=false;el.onbeforedeactivate=null}}};_.inputTimer=function(n){var that=this,el=that.el,t=that.t,value;if(n){if(t)return;that.t=setInterval(function(){value=el.value;if(!value.trim()){that.hide(1);that.q=value;return}if(value!==that.q){that.updata(value)}},that.o.delay)}else{t&&clearInterval(that.t);that.t=0}};_.getIndex=function(el,list){var l=list.length;while(l--)if(list[l]===el)return l;return-1};_.matchEl=function(el,wrap,fun){while(el!==wrap){if(fun.call(el))return el;el=el.parentNode}return NULL};_.submitForm=function(){var form=this.el.form;if(form.onsubmit){form.onsubmit()}else{form.submit()}};_.keydownMove=function(k){var that=this,ol=that.sugWrap.getElementsByTagName("OL")[0];if(!ol)return;if(that.isHide){that.isHide=false;return}var list=ol.getElementsByTagName("LI"),l=list.length,el=that.el,s=that.s,o=that.o,classNameSelect=o.classNameSelect,q=that.q||"",li;if(s){removeClass(s,classNameSelect);that.i=that.getIndex(s,list);that.s=NULL}that.i===undef&&(that.index=-1);that.i!==-1&&removeClass(list[that.i],classNameSelect);if(k===40){that.i++}else if(k===38){that.i--}if(that.i===-2){that.i=l-1}else if(that.i===l){el.value=q;that.i=-1}else if(that.i===-1){el.value=q}if(that.i!==-1&&that.i!==l){li=list[that.i];addClass(li,classNameSelect);!o.autoCompleteData&&(el.value=li.getAttribute("q"));that.s=li}};_.inputHandle=function(){var that=this,o=that.o,el=that.el,form=el.form,sugWrap=that.sugWrap,classNameSelect=o.classNameSelect,autoCompleteData=o.autoCompleteData,pressCount=0,k;el.onkeydown=function(e){e=e||window.event;k=e.keyCode;if(k===27){that.hide(2);sugWrap.getElementsByTagName("ol")[0]&&(that.isHide=true);!autoCompleteData&&(el.value=that.q);that.inputTimer();return false}else if(k>32&&k<41){if(!el.value&&sugWrap.style.display==="none"){el.blur()}else if(k===40||k===38){if(!o.pressDelay||pressCount++===0){that.isHide&&that.show();that.keydownMove(k);that.inputTimer()}else if(pressCount===o.pressDelay){pressCount=0}!isIE&&e.preventDefault()}}else if(k===13){that.inputTimer();that.hide(2);o.onSelect&&o.onSelect.call(that);if(autoCompleteData){el.value=that.s?that.s.getAttribute("q"):"";return false}if(o.noSubmit)return false}else if(k>8&&k<19){k!==9&&that.holdFocus(el,e);return}else{that.inputTimer(1)}};on(el,"keyup",function(){pressCount=0});on(el,"blur",function(){that.hide(2);sugWrap.getElementsByTagName("ol")[0]&&(that.isHide=true);that.inputTimer()});bind(sugWrap,"mouseover",function(){var li=that.matchEl(this,sugWrap,function(){return this.tagName==="LI"});if(!li)return;that.s&&removeClass(that.s,classNameSelect);addClass(li,classNameSelect);that.s=li});bind(sugWrap,"mouseout",function(){var li=that.matchEl(this,sugWrap,function(){return this.tagName==="LI"});this.tagName==="LI"&&this!==li&&removeClass(li,classNameSelect)});on(sugWrap,"mousedown",function(e){that.inputTimer();that.holdFocus(el,e)});bind(sugWrap,"mouseup",function(e){var ol=sugWrap.getElementsByTagName("OL")[0],li;if(!ol||e.which&&e.which>2||e.button&&e.button!==1&&e.button!==4)return;hasClass(this,o.classNameClose)&&that.hide();li=that.matchEl(this,sugWrap,function(){return this.tagName==="LI"});if(!li)return;el.value=li.getAttribute("q");that.hide();that.inputTimer();o.onSelect&&o.onSelect.call(that);that.i=that.getIndex(li,ol.getElementsByTagName("LI"));!o.autoCompleteData&&!o.noSubmit&&that.submitForm()})};_.fill=function(data,q){var that=this,content=that.content;if(arguments.length<2){content.innerHTML="";return}var o=that.o,templ=o.templ,classNameQueryNull=o.classNameQueryNull,classNameQuery=o.classNameQuery;this.content.innerHTML=templ?templ.call(that,data,q):function(){data=data[o.callbackDataKey||o.callbackDataNum]||[];var i=0,l=Math.min(data.length,o.n),ret=[],li;q=q.trim();for(;i<l;i++){li=data[i];li!==undef&&ret.push('<li q="'+li+'"'+(classNameQueryNull&&li.indexOf(q)>-1?"":" class="+classNameQueryNull)+">"+(classNameQuery?li.replace(q,'<span class="'+classNameQuery+'">'+q+"</span>"):li)+"</li>")}return"<ol>"+ret.join("")+"</ol>"}()};_.updata=function(q){var that=this,data=that.o.autoCompleteData||that.cache[q];that.q=q;that.i=-1;that.isHide=false;if(data!==undef){that.fill(data,q);that.show();return}that.request(q)};_.request=function(q){var that=this,o=that.o,callbackFn=o.callbackFn,callbackName=o.callbackName,onSucess=o.onSucess,onError=o.onError,onRequest=o.onRequest,callback=that.callback,url=o.url,customUrl=o.customUrl,para=o.requestParas,ret=[],k,li;if(callbackFn){var context=namespace(callbackFn),lastFnName=callbackFn.split(".").pop();context[lastFnName]=that.callback;if(context[lastFnName].repeat){context[lastFnName].context=that}}else if(callbackName){li=that.script;if(li.readyState){li.onreadystatechange=function(){if(li.readyState=="loaded"||li.readyState=="complete"){li.onreadystatechange=NULL;onSucess&&onSucess.call(that);callback(callbackName)}}}else{li.onload=function(){onSucess&&onSucess.call(that);callback(callbackName)}}}onError&&(that.script.onerror=function(){onError.call(that)});if(!that.script||!isIE||isIE9){var ref=DOC.getElementsByTagName("script")[0];li=DOC.createElement("script");li.type="text/javascript";li.async=true;if(that.script){ref.parentNode.replaceChild(li,that.script)}else{ref.parentNode.insertBefore(li,ref)}that.script=li}onRequest&&onRequest.call(this);para=function(){for(k in para)(li=para[k])!==undef&&ret.push(k+"="+para[k]);o.t&&ret.push("t"+"="+ +new Date);return ret.join("&")}();that.script.charset=o.charset?o.charset:"";that.script.src=customUrl&&customUrl.call(that,para)||url+"?"+o.requestQuery+"="+encodeURIComponent(q)+"&"+para};WIN.G||(WIN.G={}),G.suggest=G.sug=_sug}(window,document);